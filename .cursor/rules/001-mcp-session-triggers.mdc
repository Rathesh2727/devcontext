---
description: Comprehensive Memory System Session Triggers
globs: **/*
alwaysApply: true
---
# Session Lifecycle Triggers for MCP Memory

These rules define when MCP memory tools should be automatically invoked during the session lifecycle.

## Session Start Trigger

```javascript
// Automatically initialize context when the session starts
// Uses progressive loading for fast initial response (<150ms target)
onSessionStart: () => {
  mcp_cursor10x_mcp_init_context({
    session_id: "{{SESSION_ID}}",
    priority: "high",
    mode: "progressive",
  });
};
```

## Session End Trigger

```javascript
// Automatically finalize the session when it ends
// Saves checkpoint and triggers background cleanup (<300ms target)
onSessionEnd: () => {
  mcp_cursor10x_mcp_finalize_session({
    session_id: "{{SESSION_ID}}",
    save_checkpoint: true,
    summarize: true,
    conversation: [
      { role: "user", content: "{{USER_MESSAGE}}", importance: 0.7 },
      { role: "assistant", content: "{{ASSISTANT_MESSAGE}}", importance: 0.6 },
    ],
  });
};
```

## Long Idle Period Trigger

```javascript
// After long idle periods, perform memory consolidation
// This helps optimize memory storage without impacting active work
onIdlePeriod: (duration) => {
  if (duration > 5 * 60 * 1000) {
    // 5 minutes
    mcp_cursor10x_mcp_process_memory({
      session_id: "{{SESSION_ID}}",
      operation: "consolidate",
      options: { minImportance: 0.2 },
    });
  }
};
```